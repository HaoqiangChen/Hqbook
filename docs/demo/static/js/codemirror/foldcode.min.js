!function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],a):a(CodeMirror)}(function(a){"use strict";function b(b,d,f,g){function j(a){var e,f,c=h(b,d);if(!c||c.to.line-c.from.line<i)return null;for(e=b.findMarksAt(c.from),f=0;f<e.length;++f)if(e[f].__isFold&&"fold"!==g){if(!a)return null;c.cleared=!0,e[f].clear()}return c}var h,i,k,l,m;if(f&&f.call?(h=f,f=null):h=e(b,f,"rangeFinder"),"number"==typeof d&&(d=a.Pos(d,0)),i=e(b,f,"minFoldSize"),k=j(!0),e(b,f,"scanUp"))for(;!k&&d.line>b.firstLine();)d=a.Pos(d.line-1,0),k=j(!1);k&&!k.cleared&&"unfold"!==g&&(l=c(b,f,k),a.on(l,"mousedown",function(b){m.clear(),a.e_preventDefault(b)}),m=b.markText(k.from,k.to,{replacedWith:l,clearOnEnter:e(b,f,"clearOnEnter"),__isFold:!0}),m.on("clear",function(c,d){a.signal(b,"unfold",b,c,d)}),a.signal(b,"fold",b,k.from,k.to))}function c(a,b,c){var f,d=e(a,b,"widget");return"function"==typeof d&&(d=d(c.from,c.to)),"string"==typeof d?(f=document.createTextNode(d),d=document.createElement("span"),d.appendChild(f),d.className="CodeMirror-foldmarker"):d&&(d=d.cloneNode(!0)),d}function e(a,b,c){if(b&&void 0!==b[c])return b[c];var e=a.options.foldOptions;return e&&void 0!==e[c]?e[c]:d[c]}a.newFoldFunction=function(a,c){return function(d,e){b(d,e,{rangeFinder:a,widget:c})}},a.defineExtension("foldCode",function(a,c,d){b(this,a,c,d)}),a.defineExtension("isFolded",function(a){var c,b=this.findMarksAt(a);for(c=0;c<b.length;++c)if(b[c].__isFold)return!0}),a.commands.toggleFold=function(a){a.foldCode(a.getCursor())},a.commands.fold=function(a){a.foldCode(a.getCursor(),null,"fold")},a.commands.unfold=function(a){a.foldCode(a.getCursor(),null,"unfold")},a.commands.foldAll=function(b){b.operation(function(){for(var c=b.firstLine(),d=b.lastLine();d>=c;c++)b.foldCode(a.Pos(c,0),null,"fold")})},a.commands.unfoldAll=function(b){b.operation(function(){for(var c=b.firstLine(),d=b.lastLine();d>=c;c++)b.foldCode(a.Pos(c,0),null,"unfold")})},a.registerHelper("fold","combine",function(){var a=Array.prototype.slice.call(arguments,0);return function(b,c){var d,e;for(d=0;d<a.length;++d)if(e=a[d](b,c))return e}}),a.registerHelper("fold","auto",function(a,b){var d,e,c=a.getHelpers(b,"fold");for(d=0;d<c.length;d++)if(e=c[d](a,b))return e});var d={rangeFinder:a.fold.auto,widget:"â†”",minFoldSize:0,scanUp:!1,clearOnEnter:!0};a.defineOption("foldOptions",null),a.defineExtension("foldOption",function(a,b){return e(this,a,b)})});